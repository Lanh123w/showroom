<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω m√†u xe</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <div class="container mt-2">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark rounded px-3">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="mainNav">
            <ul class="navbar-nav mx-auto">
              <div class="text-white ms-auto" th:if="${session.admin != null}">
                üëã Xin ch√†o, <strong th:text="${session.admin.username}">Admin</strong>
              </div>
      
              <li class="nav-item"><a class="nav-link" href="/">Trang ch·ªß</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/promotion-form">Ch·ªânh s·ª≠a khuy·∫øn m√£i</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/news-form">Ch·ªânh s·ª≠a tin t·ª©c</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/create-account">T·∫°o t√†i kho·∫£n</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/change-password">ƒê·ªïi m·∫≠t kh·∫©u</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/accounts">Danh s√°ch t√†i kho·∫£n</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/services">Qu·∫£n l√≠ d·ªãch v·ª•</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/categories">Danh s√°ch lo·∫°i xe</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/colors">Ch·ªânh s·ª≠a m√†u xe</a></li>
              <li class="nav-item"><a class="nav-link" href="/admin/bookings">Danh s√°ch ƒë·∫∑t l·ªãch</a></li>
            </ul>
          </div>
        </nav>
      </div>
    <h3 class="mb-3">üé® Qu·∫£n l√Ω m√†u xe</h3>

   
    <form th:action="@{/admin/colors/save}" method="post" th:object="${color}" class="row g-3 mb-4">
        <input type="hidden" th:field="*{id}" />
    
        <div class="col-md-6">
            <label for="name" class="form-label">T√™n m√†u</label>
            <select class="form-select" th:field="*{name}" required>
                <option value="" disabled selected>-- Ch·ªçn m√†u --</option>
                <option th:each="c : ${colors}"
                        th:value="${c.name}"
                        th:text="${c.name}">
                </option>
            </select>
        </div>
    
        <div class="col-md-6">
            <label for="priceAdjustment" class="form-label">Gi√° c·ªông th√™m</label>
            <input type="number" class="form-control" th:field="*{priceAdjustment}" required>
        </div>
    
        <div class="col-12">
            <button type="submit" class="btn btn-primary">L∆∞u m√†u</button>
        </div>
    </form>
    

 
    <table class="table table-bordered">
        <thead>
            <tr><th>ID</th><th>T√™n m√†u</th><th>Gi√° c·ªông th√™m</th><th>H√†nh ƒë·ªông</th></tr>
        </thead>
        <tbody>
            <tr th:each="color : ${colors}">
                <td th:text="${color.id}"></td>
                <td th:text="${color.name}"></td>
                <td th:text="${color.priceAdjustment}"></td>
                <td>
                    <a th:href="@{'/admin/colors/edit/' + ${color.id}}" class="btn btn-warning btn-sm">S·ª≠a</a>
                    <a th:href="@{'/admin/colors/delete/' + ${color.id}}" class="btn btn-danger btn-sm"
                       onclick="return confirm('X√≥a m√†u n√†y?')">X√≥a</a>
                </td>
            </tr>
        </tbody>
    </table>

    <hr class="my-4">

    <h4>üöó G√°n m√†u cho xe</h4>

    <!-- Form g√°n m√†u cho xe -->
    <form th:action="@{/admin/colors/mapping/save}" method="post" class="row g-3 mb-4">
        <div class="col-md-6">
            <label for="carId" class="form-label">Ch·ªçn xe</label>
            <select class="form-select" name="carId" required>
                <option th:each="car : ${cars}" th:value="${car.id}" th:text="${car.name}"></option>
            </select>
        </div>
        <div class="col-md-6">
            <label for="colorId" class="form-label">Ch·ªçn m√†u</label>
            <select class="form-select" name="colorId" required>
                <option th:each="color : ${colors}" th:value="${color.id}" th:text="${color.name}"></option>
            </select>
        </div>
        <div class="col-12">
            <button type="submit" class="btn btn-success">G√°n m√†u</button>
        </div>
    </form>

    <h5 class="mt-4 mb-3">üìã Danh s√°ch m√†u ƒë√£ g√°n cho xe</h5>
    <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle">
            <thead class="table-dark text-center">
                <tr>
                    <th style="width: 30%">T√™n xe</th>
                    <th style="width: 30%">M√†u</th>
                    <th style="width: 40%">H√†nh ƒë·ªông</th>
                </tr>
            </thead>
            <tbody>
                <th:block th:each="car : ${cars}">
                    <th:block th:if="${#lists.isEmpty(car.colors)}">
                        <tr>
                            <td th:text="${car.name}" class="text-center fw-semibold"></td>
                            <td class="text-center text-muted">Ch∆∞a c√≥ m√†u</td>
                            <td class="text-center">
                                <span class="text-muted">‚Äî</span>
                            </td>
                        </tr>
                    </th:block>
    
                    <th:block th:each="color, iterStat : ${car.colors}">
                        <tr>
                            <td th:if="${iterStat.index == 0}"
                                th:rowspan="${#lists.size(car.colors)}"
                                th:text="${car.name}"
                                class="text-center align-middle fw-semibold">
                            </td>
                            <td th:text="${color.name}" class="text-center"></td>
                            <td class="text-center">
                                <a th:href="@{'/admin/colors/mapping/delete?carId=' + ${car.id} + '&colorId=' + ${color.id}}"
                                   class="btn btn-danger btn-sm"
                                   onclick="return confirm('X√≥a m√†u n√†y kh·ªèi xe?')">X√≥a</a>
                            </td>
                        </tr>
                    </th:block>
                </th:block>
            </tbody>
        </table>
    </div>
    
    
</body>
</html>
