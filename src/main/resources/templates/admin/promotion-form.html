<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Qu·∫£n l√Ω khuy·∫øn m√£i</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body> 
  <div class="container mt-2">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark rounded px-3">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="mainNav">
        <ul class="navbar-nav mx-auto">
          <div class="text-white ms-auto" th:if="${session.admin != null}">
            üëã Xin ch√†o, <strong th:text="${session.admin.username}">Admin</strong>
          </div>
  
          <li class="nav-item"><a class="nav-link" href="/">Trang ch·ªß</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/promotion-form">Ch·ªânh s·ª≠a khuy·∫øn m√£i</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/news-form">Ch·ªânh s·ª≠a tin t·ª©c</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/create-account">T·∫°o t√†i kho·∫£n</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/change-password">ƒê·ªïi m·∫≠t kh·∫©u</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/accounts">Danh s√°ch t√†i kho·∫£n</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/services">Qu·∫£n l√≠ d·ªãch v·ª•</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/categories">Danh s√°ch lo·∫°i xe</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/colors">Ch·ªânh s·ª≠a m√†u xe</a></li>
          <li class="nav-item"><a class="nav-link" href="/admin/bookings">Danh s√°ch ƒë·∫∑t l·ªãch</a></li>
        </ul>
      </div>
    </nav>
  </div>
  <div class="container mt-5">
  
    <div th:if="${message}" class="alert alert-success text-center">
      <span th:text="${message}">Thao t√°c th√†nh c√¥ng!</span>
    </div>

      
<div class="container mt-5">

  <div class="card shadow-sm mb-5">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0"
          th:text="${promotion != null and promotion.id != null ? '‚úèÔ∏è S·ª≠a khuy·∫øn m√£i' : '‚ûï Th√™m khuy·∫øn m√£i'}">
        Qu·∫£n l√Ω khuy·∫øn m√£i
      </h4>
    </div>
    <div class="card-body bg-light">
      <form th:action="@{/admin/promotion-form/save}" method="post" th:object="${promotion}" enctype="multipart/form-data">
        <input type="hidden" th:field="*{id}">

        <div class="mb-3">
          <label class="form-label fw-bold">üéØ Ti√™u ƒë·ªÅ khuy·∫øn m√£i</label>
          <input type="text" th:field="*{title}" class="form-control" placeholder="VD: Gi·∫£m gi√° 10 tri·ªáu cho Ford Ranger" required>
        </div>

        <div class="mb-3">
          <label class="form-label fw-bold">üìù M√¥ t·∫£ chi ti·∫øt</label>
          <textarea th:field="*{description}" class="form-control" rows="4" placeholder="N·ªôi dung khuy·∫øn m√£i..." required></textarea>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label fw-bold">üìÖ Ng√†y b·∫Øt ƒë·∫ßu</label>
            <input type="date" th:field="*{startDate}" class="form-control" required>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label fw-bold">üìÖ Ng√†y k·∫øt th√∫c</label>
            <input type="date" th:field="*{endDate}" class="form-control" required>
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label fw-bold">üñºÔ∏è ·∫¢nh minh h·ªça</label>
          <input type="file" name="imageFile" class="form-control" accept="image/*">
          <div th:if="${promotion != null and promotion.imagePath != null}" class="mt-3">
            <label class="form-label">·∫¢nh hi·ªán t·∫°i:</label><br>
            <img th:src="@{'/images/' + ${promotion.imagePath}}" class="img-thumbnail shadow-sm" style="max-height: 150px;">
          </div>
        </div>

        <div class="text-end mt-4">
          <button type="submit" class="btn btn-success px-4">üíæ L∆∞u</button>
          <a href="/admin/dashboard" class="btn btn-secondary ms-2 px-4">‚Ü©Ô∏è Quay l·∫°i</a>
        </div>
      </form>
    </div>
  </div>


  <div class="card shadow-sm">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">üìã Danh s√°ch khuy·∫øn m√£i hi·ªán c√≥</h5>
    </div>
    <div class="card-body bg-white">
      <table class="table table-bordered table-hover">
        <thead class="table-light">
          <tr>
            <th>#</th>
            <th>Ti√™u ƒë·ªÅ</th>
            <th>Th·ªùi gian</th>
            <th>·∫¢nh</th>
            <th>Thao t√°c</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="promo, stat : ${promotions}">
            <td th:text="${stat.index + 1}">1</td>
            <td th:text="${promo.title}">Ti√™u ƒë·ªÅ</td>
            <td>
              <span th:text="${#temporals.format(promo.startDate, 'dd/MM/yyyy')}">01/10/2025</span> ‚Üí
              <span th:text="${#temporals.format(promo.endDate, 'dd/MM/yyyy')}">30/10/2025</span>
            </td>
            <td>
              <img th:src="@{'/images/' + ${promo.imagePath}}" class="img-thumbnail" style="height:50px;">
            </td>
            <td>
              <a th:href="@{'/admin/promotion-form/edit/' + ${promo.id}}" class="btn btn-sm btn-warning">S·ª≠a</a>
              <a th:href="@{'/admin/promotion-form/delete/' + ${promo.id}}" class="btn btn-sm btn-danger"
                 onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a khuy·∫øn m√£i n√†y kh√¥ng?')">X√≥a</a>
            </td>
          </tr>
          <tr th:if="${promotions.size() == 0}">
            <td colspan="5" class="text-center text-muted">Kh√¥ng c√≥ khuy·∫øn m√£i n√†o.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
